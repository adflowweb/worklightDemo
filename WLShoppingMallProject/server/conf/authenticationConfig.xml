<?xml version="1.0" encoding="UTF-8"?>
<tns:loginConfiguration xmlns:tns="http://www.worklight.com/auth/config"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

	<!-- Licensed Materials - Property of IBM 5725-G92 (C) Copyright IBM Corp. 
		2006, 2013. All Rights Reserved. US Government Users Restricted Rights - 
		Use, duplication or disclosure restricted by GSA ADP Schedule Contract with 
		IBM Corp. -->

	<!-- Uncomment the next element to protect the worklight console and the 
		first section in securityTests below. -->
	<staticResources>
		<!-- <resource id="worklightConsole" securityTest="WorklightConsole"> <urlPatterns>/console*</urlPatterns> 
			</resource> -->
		<resource id="subscribeServlet" securityTest="SubscribeServlet">
			<urlPatterns>/subscribeSMS*</urlPatterns>
		</resource>
	</staticResources>

	<!-- Sample security tests Even if not used there will be some default webSecurityTest 
		and mobileSecurityTest Attention: if using <testAppAuthenticity/> test below 
		,<publicSigningKey> element must be added to application-descriptor.xml as 
		well. -->

	<securityTests>

		<customSecurityTest name="WLShoppersSecurityTest">
			<test isInternalUserID="true" realm="WLShoppersRealm" />
		</customSecurityTest>
		<customSecurityTest name="SubscribeServlet">
			<test realm="SubscribeServlet" isInternalUserID="true" />
		</customSecurityTest>

	</securityTests>

	<realms>
		<realm name="WLShoppersRealm" loginModule="LDAPLoginModule">
			<className>com.worklight.core.auth.ext.FormBasedAuthenticator</className>
		</realm>
		<realm name="SampleAppRealm" loginModule="StrongDummy">
			<className>com.worklight.core.auth.ext.FormBasedAuthenticator</className>
		</realm>

		<realm name="WorklightConsole" loginModule="requireLogin">
			<className>com.worklight.core.auth.ext.FormBasedAuthenticator</className>
			<onLoginUrl>/console</onLoginUrl>
		</realm>

		<realm name="SubscribeServlet" loginModule="rejectAll">
			<className>com.worklight.core.auth.ext.HeaderAuthenticator</className>
		</realm>

	</realms>

	<loginModules>

		<loginModule name="StrongDummy">
			<className>com.worklight.core.auth.ext.NonValidatingLoginModule</className>
		</loginModule>

		<loginModule name="requireLogin">
			<className>com.worklight.core.auth.ext.SingleIdentityLoginModule</className>
		</loginModule>

		<loginModule name="rejectAll">
			<className>com.worklight.core.auth.ext.RejectingLoginModule</className>
		</loginModule>
		<loginModule name="LDAPLoginModule">
			<className>com.worklight.core.auth.ext.LdapLoginModule</className>

			<parameter name="ldapProviderUrl" value="ldap://192.168.0.171" />
			<parameter name="ldapTimeoutMs" value="2000" />
			<parameter name="ldapSecurityAuthentication" value="simple" />
			<parameter name="validationType" value="searchPattern" />
			<parameter name="ldapSecurityPrincipalPattern"
				value="cn={username},ou=consumers,dc=acmeshop,dc=com" />
			<parameter name="ldapSearchFilterPattern"
				value="(&amp;(objectClass=groupOfUniqueNames)(uniqueMember=cn={username},ou=consumers,dc=acmeshop,dc=com))" />
			<parameter name="ldapSearchBase" value="dc=acmeshop,dc=com" />
			<!-- parameter name="ldapSecurityPrincipalPattern" value="cn={username},ou=developers,dc=acmeshop,dc=com" 
				/> <parameter name="ldapSearchFilterPattern" value="(&amp;(objectClass=inetOrgPerson))" 
				/ -->
			<parameter name="ldapSearchBase" value="dc=acmeshop,dc=com" />
		</loginModule>
	</loginModules>

</tns:loginConfiguration>
